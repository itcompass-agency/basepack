# Redis Configuration File
# Security hardening for production use
# CVE-2025-49844 mitigation

# Network
bind 0.0.0.0
protected-mode yes
port 6379

# Authentication
# IMPORTANT: This will be overridden by --requirepass in docker-compose
# requirepass will be set via environment variable for better security
# requirepass YOUR_STRONG_PASSWORD_HERE

# General
timeout 0
tcp-keepalive 300
daemonize no
pidfile /var/run/redis_6379.pid

# Logging
loglevel notice
logfile ""

# Persistence (as per current setup)
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# Replication
replica-read-only no

# Security hardening
# Disable dangerous commands
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command CONFIG ""
rename-command SHUTDOWN ""
rename-command DEBUG ""

# Memory management
maxmemory-policy allkeys-lru

# Disable Lua scripting security bypass (CVE-2025-49844 mitigation)
# Note: This requires Redis 7.0.15+ or 7.2.4+
# lua-disable-commands EVAL EVALSHA

# Performance
maxclients 10000
